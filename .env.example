# ╔════════════════════════════════════════════════════════════════════════════╗
# ║                         OVERWATCH CONFIGURATION                            ║
# ║                                                                            ║
# ║  Copy this file to .env and adjust values for your environment.            ║
# ║  All services read from this single .env file at the project root.         ║
# ╚════════════════════════════════════════════════════════════════════════════╝

# ──────────────────────────────────────────────────────────────────────────────
# INFRASTRUCTURE (Docker Compose host ports)
# ──────────────────────────────────────────────────────────────────────────────
# PostgreSQL: localhost:5450
# Redis:      localhost:6390
# NATS:       localhost:4230
# NATS HTTP:  localhost:8230

# ──────────────────────────────────────────────────────────────────────────────
# SHARED SECRETS
# ──────────────────────────────────────────────────────────────────────────────
TOKEN_SIGNING_KEY=change-me-in-production-at-least-32-chars-long

# ══════════════════════════════════════════════════════════════════════════════
# IDENTITY SERVICE (gRPC :50051)
# ══════════════════════════════════════════════════════════════════════════════

# Server
IDENTITY_SERVER_HOST=0.0.0.0
IDENTITY_SERVER_PORT=50051
IDENTITY_SERVER_ENABLE_REFLECTION=true
IDENTITY_SERVER_ENABLE_HEALTH_CHECK=true
IDENTITY_SERVER_SHUTDOWN_TIMEOUT=30s

# Database
IDENTITY_DATABASE_HOST=localhost
IDENTITY_DATABASE_PORT=5450
IDENTITY_DATABASE_USER=overwatch
IDENTITY_DATABASE_PASSWORD=overwatch
IDENTITY_DATABASE_NAME=overwatch_identity
IDENTITY_DATABASE_SSL_MODE=disable
IDENTITY_DATABASE_MAX_CONNS=25
IDENTITY_DATABASE_MIN_CONNS=5
IDENTITY_DATABASE_MAX_CONN_LIFETIME=1h
IDENTITY_DATABASE_MAX_CONN_IDLE_TIME=30m
IDENTITY_DATABASE_HEALTH_CHECK_PERIOD=1m

# Redis
IDENTITY_REDIS_HOST=localhost
IDENTITY_REDIS_PORT=6390
IDENTITY_REDIS_PASSWORD=
IDENTITY_REDIS_DB=0
IDENTITY_REDIS_POOL_SIZE=10
IDENTITY_REDIS_MIN_IDLE_CONNS=5
IDENTITY_REDIS_DIAL_TIMEOUT=5s
IDENTITY_REDIS_READ_TIMEOUT=3s
IDENTITY_REDIS_WRITE_TIMEOUT=3s

# NATS
IDENTITY_NATS_URL=nats://localhost:4230
IDENTITY_NATS_SUBJECT_PREFIX=overwatch.identity
IDENTITY_NATS_MAX_RECONNECTS=10
IDENTITY_NATS_RECONNECT_WAIT=2s

# Token (JWT)
IDENTITY_TOKEN_ISSUER=overwatch-identity
IDENTITY_TOKEN_AUDIENCE=overwatch
IDENTITY_TOKEN_ACCESS_DURATION=24h
IDENTITY_TOKEN_REFRESH_DURATION=168h

# Service Identity (Provenance)
IDENTITY_SERVICE_IDENTITY_ID=identity-service
IDENTITY_SERVICE_IDENTITY_NAME=identity
IDENTITY_SERVICE_IDENTITY_PRIVATE_KEY_PATH=
IDENTITY_SERVICE_IDENTITY_PRIVATE_KEY=
IDENTITY_SERVICE_IDENTITY_GENERATE_IF_MISSING=true